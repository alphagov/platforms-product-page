function nodeListForEach(e,o){if(window.NodeList.prototype.forEach)return e.forEach(o);for(var i=0;i<e.length;i++)o.call(window,e[i],i,e)}function Cookies(){this.cookieName="platform_cookies_policy",this.cookieDuration=365,this.trackingId="GTM-MFJWJNW",this.gaCookies={main:"_ga",ga4Id:"_ga_LGKT9WEGY2"},this.getCookieDuration=function(){return this.cookieDuration},this.getCookiePolicyName=function(){return this.cookieName},this.getGaCookies=function(){return this.gaCookies}}Cookies.prototype.hasConsentForAnalytics=function(){var e=JSON.parse(this.getCookie(this.cookieName));return!!e&&e.analytics},Cookies.prototype.loadGtmScript=function(){var e,o,i,t,s="dataLayer";e=window,o=document,i=this.trackingId,e[s]=e[s]||[],e[s].push({"gtm.start":new Date().getTime(),event:"gtm.js"}),(t=o.createElement("script")).async=!0,t.src="https://www.googletagmanager.com/gtm.js?id="+i+("dataLayer"!==s?"&l="+s:""),document.head.appendChild(t)},Cookies.prototype.setBannerCookieConsent=function(e){this.setCookie(this.cookieName,JSON.stringify({analytics:e}),{days:this.cookieDuration}),this.$module.showBannerConfirmationMessage(e),this.$module.cookieBannerConfirmationMessage.focus(),e&&this.initAnalytics()},Cookies.prototype.showCookieBanner=function(){if(!this.onCookiesPage()){var e=this.getCookie(this.cookieName);this.$module&&!e&&this.$module.removeAttribute("hidden")}},Cookies.prototype.initCookieBanner=function(e){this.$module=e,this.$module.hideCookieMessage=this.hideCookieMessage.bind(this),this.$module.showBannerConfirmationMessage=this.showBannerConfirmationMessage.bind(this),this.$module.setBannerCookieConsent=this.setBannerCookieConsent.bind(this),this.$module.cookieBannerConfirmationMessage=this.$module.querySelector(".govuk-cookie-banner__confirmation-message"),this.$module&&(this.$hideLink=this.$module.querySelector("button[data-hide-cookie-message]"),this.$hideLink&&this.$hideLink.addEventListener("click",this.$module.hideCookieMessage),this.$acceptCookiesLink=this.$module.querySelector("button[data-accept-cookies=true]"),this.$acceptCookiesLink&&this.$acceptCookiesLink.addEventListener("click",(function(){this.$module.setBannerCookieConsent(!0)}).bind(this)),this.$rejectCookiesLink=this.$module.querySelector("button[data-accept-cookies=false]"),this.$rejectCookiesLink&&this.$rejectCookiesLink.addEventListener("click",(function(){this.$module.setBannerCookieConsent(!1)}).bind(this)),this.showCookieBanner())},Cookies.prototype.initAnalytics=function(){this.loadGtmScript()},Cookies.prototype.hideCookieMessage=function(e){this.$module&&(this.$module.style.display="none"),e.target&&e.preventDefault()},Cookies.prototype.showBannerConfirmationMessage=function(e){this.$cookieBannerMainContent=document.querySelector(".govuk-cookie-banner__message"),this.$cookieBannerConfirmationMessage=document.querySelector(".govuk-cookie-banner__confirmation-message"),this.$cookieBannerConfirmationMessage.querySelector(".govuk-cookie-banner__content .govuk-body").insertAdjacentText("afterbegin",e?"You’ve accepted analytics cookies.":"You’ve rejected analytics cookies."),this.$cookieBannerMainContent.setAttribute("hidden",!0),this.$cookieBannerConfirmationMessage.removeAttribute("hidden"),this.$cookieBannerConfirmationMessage.focus()},Cookies.prototype.onCookiesPage=function(){return window.location.pathname.indexOf("cookies")>-1},Cookies.prototype.getCookie=function(e){for(var o=e+"=",i=document.cookie.split(";"),t=0,s=i.length;t<s;t++){for(var n=i[t];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(o))return decodeURIComponent(n.substring(o.length))}return null},Cookies.prototype.setCookie=function(e,o,i){void 0===i&&(i={});var t=e+"="+o+"; path=/";if(i.days){var s=new Date;s.setTime(s.getTime()+864e5*i.days),t=t+"; expires="+s.toGMTString()}"https:"===document.location.protocol&&(t+="; Secure"),document.cookie=t},Cookies.prototype.deleteCookie=function(e){e&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/",document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain="+window.location.hostname+";path=/",document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;domain=."+window.location.hostname+";path=/")};var $cookieBanner=document.querySelector('[data-module="cookie-banner"]'),cookies=new Cookies;function CookiesPage(e){this.$module=e}$cookieBanner&&cookies.initCookieBanner($cookieBanner),cookies.hasConsentForAnalytics()&&cookies.initAnalytics(),CookiesPage.prototype.init=function(){this.$cookiePage=this.$module,this.$cookiePage&&(this.$cookieForm=this.$cookiePage.querySelector(".js-cookies-page-form"),this.$cookieFormFieldsets=this.$cookieForm.querySelectorAll(".js-cookies-page-form-fieldset"),this.$successNotification=this.$cookiePage.querySelector(".js-cookies-page-success"),nodeListForEach(this.$cookieFormFieldsets,(function(e){this.showUserPreference(e,cookies.getCookie(cookies.getCookiePolicyName())),e.removeAttribute("hidden")}).bind(this)),this.$cookieForm.querySelector(".js-cookies-form-button").removeAttribute("hidden"),this.$cookieForm.addEventListener("submit",this.savePreferences.bind(this)))},CookiesPage.prototype.savePreferences=function(e){e.preventDefault();var o={},i=!!(cookies.getCookie(cookies.getGaCookies().main)&&cookies.getCookie(cookies.getGaCookies().ga4Id));nodeListForEach(this.$cookieFormFieldsets,(function(e){var i=this.getCookieType(e),t=e.querySelector("input[name="+i+"]:checked").value;o[i]="yes"===t}).bind(this)),i&&!o.analytics&&(cookies.deleteCookie(cookies.getGaCookies().main),cookies.deleteCookie(cookies.getGaCookies().ga4Id)),cookies.setCookie(cookies.getCookiePolicyName(),JSON.stringify(o),{days:cookies.getCookieDuration()}),this.showSuccessNotification()},CookiesPage.prototype.showUserPreference=function(e,o){var i=this.getCookieType(e),t=!1,s=JSON.parse(o);i&&s&&void 0!==s[i]&&(t=s[i]);var n=t?"yes":"no";e.querySelector("input[name="+i+"][value="+n+"]").checked=!0},CookiesPage.prototype.showSuccessNotification=function(){this.$successNotification.removeAttribute("hidden"),this.$successNotification.getAttribute("tabindex")||this.$successNotification.setAttribute("tabindex","-1"),this.$successNotification.focus(),window.scrollTo(0,0)},CookiesPage.prototype.getCookieType=function(e){return e.id};var $cookiesPage=document.querySelector('[data-module="app-cookies-page"]'),cookiesPage=new CookiesPage($cookiesPage);$cookiesPage&&cookiesPage.init();